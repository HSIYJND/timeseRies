<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>timeseRies</title>
  <meta name="description" content="This is a web complement to MATH 342 (Time series) given at EPFL.">
  <meta name="generator" content="bookdown  and GitBook 2.6.7">

  <meta property="og:title" content="timeseRies" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This is a web complement to MATH 342 (Time series) given at EPFL." />
  <meta name="github-repo" content="lbelzile/timeseRies" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="timeseRies" />
  
  <meta name="twitter:description" content="This is a web complement to MATH 342 (Time series) given at EPFL." />
  

<meta name="author" content="Léo Belzile">



  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="covariates-and-dynamic-linear-models.html">
<link rel="next" href="state-space-models-and-the-kalman-filter.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  { background-color: #f8f8f8; }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ef2929; } /* Alert */
code span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #c4a000; } /* Attribute */
code span.bn { color: #0000cf; } /* BaseN */
code span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4e9a06; } /* Char */
code span.cn { color: #000000; } /* Constant */
code span.co { color: #8f5902; font-style: italic; } /* Comment */
code span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
code span.dt { color: #204a87; } /* DataType */
code span.dv { color: #0000cf; } /* DecVal */
code span.er { color: #a40000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #0000cf; } /* Float */
code span.fu { color: #000000; } /* Function */
code span.im { } /* Import */
code span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #204a87; font-weight: bold; } /* Keyword */
code span.op { color: #ce5c00; font-weight: bold; } /* Operator */
code span.ot { color: #8f5902; } /* Other */
code span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
code span.sc { color: #000000; } /* SpecialChar */
code span.ss { color: #4e9a06; } /* SpecialString */
code span.st { color: #4e9a06; } /* String */
code span.va { color: #000000; } /* Variable */
code span.vs { color: #4e9a06; } /* VerbatimString */
code span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="css/style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Time Series</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preliminary remarks</a></li>
<li class="chapter" data-level="1" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i><b>1</b> Introduction</a><ul>
<li class="chapter" data-level="1.1" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html"><i class="fa fa-check"></i><b>1.1</b> Exploratory Data Analysis</a><ul>
<li class="chapter" data-level="1.1.1" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html#libraries"><i class="fa fa-check"></i><b>1.1.1</b> Libraries</a></li>
<li class="chapter" data-level="1.1.2" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html#loading-datasets"><i class="fa fa-check"></i><b>1.1.2</b> Loading datasets</a></li>
<li class="chapter" data-level="1.1.3" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html#time-series-objects-and-basic-plots"><i class="fa fa-check"></i><b>1.1.3</b> Time series objects and basic plots</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="introduction-to-the-basic-time-series-functions.html"><a href="introduction-to-the-basic-time-series-functions.html"><i class="fa fa-check"></i><b>1.2</b> Introduction to the basic time series functions</a><ul>
<li class="chapter" data-level="1.2.1" data-path="introduction-to-the-basic-time-series-functions.html"><a href="introduction-to-the-basic-time-series-functions.html#exercise-1-beaver-temperature"><i class="fa fa-check"></i><b>1.2.1</b> Exercise 1: Beaver temperature</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="second-order-stationarity.html"><a href="second-order-stationarity.html"><i class="fa fa-check"></i><b>1.3</b> Second order stationarity</a><ul>
<li class="chapter" data-level="1.3.1" data-path="second-order-stationarity.html"><a href="second-order-stationarity.html#exercise-2-sp500-daily-returns"><i class="fa fa-check"></i><b>1.3.1</b> Exercise 2: SP500 daily returns</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="simulations.html"><a href="simulations.html"><i class="fa fa-check"></i><b>1.4</b> Simulations</a><ul>
<li class="chapter" data-level="1.4.1" data-path="simulations.html"><a href="simulations.html#exercise-3-simulated-data"><i class="fa fa-check"></i><b>1.4.1</b> Exercise 3: Simulated data</a></li>
</ul></li>
<li class="chapter" data-level="1.5" data-path="spectral-analysis.html"><a href="spectral-analysis.html"><i class="fa fa-check"></i><b>1.5</b> Spectral analysis</a></li>
<li class="chapter" data-level="1.6" data-path="smoothing-and-detrending.html"><a href="smoothing-and-detrending.html"><i class="fa fa-check"></i><b>1.6</b> Smoothing and detrending</a><ul>
<li class="chapter" data-level="1.6.1" data-path="smoothing-and-detrending.html"><a href="smoothing-and-detrending.html#exercise-4-mauna-loa-atmospheric-co2-concentration"><i class="fa fa-check"></i><b>1.6.1</b> Exercise 4: Mauna Loa Atmospheric CO<sub>2</sub> Concentration</a></li>
</ul></li>
<li class="chapter" data-level="1.7" data-path="solutions-to-exercises.html"><a href="solutions-to-exercises.html"><i class="fa fa-check"></i><b>1.7</b> Solutions to Exercises</a><ul>
<li class="chapter" data-level="1.7.1" data-path="solutions-to-exercises.html"><a href="solutions-to-exercises.html#solutions-1-beaver-temperature"><i class="fa fa-check"></i><b>1.7.1</b> Solutions 1: Beaver temperature</a></li>
<li class="chapter" data-level="1.7.2" data-path="solutions-to-exercises.html"><a href="solutions-to-exercises.html#solutions-2-sp500-daily-returns"><i class="fa fa-check"></i><b>1.7.2</b> Solutions 2: SP500 daily returns</a></li>
<li class="chapter" data-level="1.7.3" data-path="solutions-to-exercises.html"><a href="solutions-to-exercises.html#solutions-3-simulated-data"><i class="fa fa-check"></i><b>1.7.3</b> Solutions 3: Simulated data</a></li>
<li class="chapter" data-level="1.7.4" data-path="solutions-to-exercises.html"><a href="solutions-to-exercises.html#solutions-4-mauna-loa-atmospheric-co2-concentration"><i class="fa fa-check"></i><b>1.7.4</b> Solutions 4: Mauna Loa Atmospheric CO<sub>2</sub> Concentration</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="likelihood-estimation-and-the-boxjenkins-method.html"><a href="likelihood-estimation-and-the-boxjenkins-method.html"><i class="fa fa-check"></i><b>2</b> Likelihood estimation and the Box–Jenkins method</a><ul>
<li class="chapter" data-level="2.1" data-path="manual-maximum-likelihood-estimation.html"><a href="manual-maximum-likelihood-estimation.html"><i class="fa fa-check"></i><b>2.1</b> Manual maximum likelihood estimation</a><ul>
<li class="chapter" data-level="2.1.1" data-path="manual-maximum-likelihood-estimation.html"><a href="manual-maximum-likelihood-estimation.html#exercise-1-ubs-stock-returns"><i class="fa fa-check"></i><b>2.1.1</b> Exercise 1: UBS stock returns</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="boxjenkins-methodology-for-arma-models.html"><a href="boxjenkins-methodology-for-arma-models.html"><i class="fa fa-check"></i><b>2.2</b> Box–Jenkins methodology for ARMA models</a><ul>
<li class="chapter" data-level="2.2.1" data-path="boxjenkins-methodology-for-arma-models.html"><a href="boxjenkins-methodology-for-arma-models.html#exercise-2-simulated-series"><i class="fa fa-check"></i><b>2.2.1</b> Exercise 2: Simulated series</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="information-criterion-model-selection-and-profile-likelihood.html"><a href="information-criterion-model-selection-and-profile-likelihood.html"><i class="fa fa-check"></i><b>2.3</b> Information criterion, model selection and profile likelihood</a><ul>
<li class="chapter" data-level="2.3.1" data-path="information-criterion-model-selection-and-profile-likelihood.html"><a href="information-criterion-model-selection-and-profile-likelihood.html#exercise-3-lake-erie-height"><i class="fa fa-check"></i><b>2.3.1</b> Exercise 3: Lake Erie height</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="solutions-to-exercises-1.html"><a href="solutions-to-exercises-1.html"><i class="fa fa-check"></i><b>2.4</b> Solutions to Exercises</a><ul>
<li class="chapter" data-level="2.4.1" data-path="solutions-to-exercises-1.html"><a href="solutions-to-exercises-1.html#exercise-1-ubs-stock-returns-1"><i class="fa fa-check"></i><b>2.4.1</b> Exercise 1: UBS stock returns</a></li>
<li class="chapter" data-level="2.4.2" data-path="solutions-to-exercises-1.html"><a href="solutions-to-exercises-1.html#exercise-2-simulated-series-1"><i class="fa fa-check"></i><b>2.4.2</b> Exercise 2: Simulated series</a></li>
<li class="chapter" data-level="2.4.3" data-path="solutions-to-exercises-1.html"><a href="solutions-to-exercises-1.html#exercise-3-lake-erie-height-1"><i class="fa fa-check"></i><b>2.4.3</b> Exercise 3: Lake Erie height</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="seasonal-arima-and-garch-models.html"><a href="seasonal-arima-and-garch-models.html"><i class="fa fa-check"></i><b>3</b> Seasonal ARIMA and GARCH models</a><ul>
<li class="chapter" data-level="3.1" data-path="sarima-models-estimation-and-forecasting.html"><a href="sarima-models-estimation-and-forecasting.html"><i class="fa fa-check"></i><b>3.1</b> SARIMA models: estimation and forecasting</a><ul>
<li class="chapter" data-level="3.1.1" data-path="sarima-models-estimation-and-forecasting.html"><a href="sarima-models-estimation-and-forecasting.html#mauna-loa-co2-dataset"><i class="fa fa-check"></i><b>3.1.1</b> Mauna Loa CO<sub>2</sub> dataset</a></li>
<li class="chapter" data-level="3.1.2" data-path="sarima-models-estimation-and-forecasting.html"><a href="sarima-models-estimation-and-forecasting.html#exercice-1-nottingham-average-monthly-temperature-and-hong-kong-monthly-exports"><i class="fa fa-check"></i><b>3.1.2</b> Exercice 1: Nottingham average monthly temperature and Hong Kong monthly exports</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="boostrap-methods-for-time-series.html"><a href="boostrap-methods-for-time-series.html"><i class="fa fa-check"></i><b>3.2</b> Boostrap methods for time series</a><ul>
<li class="chapter" data-level="3.2.1" data-path="boostrap-methods-for-time-series.html"><a href="boostrap-methods-for-time-series.html#bootstrapping-a-linear-model"><i class="fa fa-check"></i><b>3.2.1</b> Bootstrapping a linear model</a></li>
<li class="chapter" data-level="3.2.2" data-path="boostrap-methods-for-time-series.html"><a href="boostrap-methods-for-time-series.html#testing-for-heteroscedasticity"><i class="fa fa-check"></i><b>3.2.2</b> Testing for heteroscedasticity</a></li>
<li class="chapter" data-level="3.2.3" data-path="boostrap-methods-for-time-series.html"><a href="boostrap-methods-for-time-series.html#ar-sieve-bootstrap"><i class="fa fa-check"></i><b>3.2.3</b> AR-sieve bootstrap</a></li>
<li class="chapter" data-level="3.2.4" data-path="boostrap-methods-for-time-series.html"><a href="boostrap-methods-for-time-series.html#boostrap-models-for-uncertainty-assesment"><i class="fa fa-check"></i><b>3.2.4</b> Boostrap models for uncertainty assesment</a></li>
<li class="chapter" data-level="3.2.5" data-path="boostrap-methods-for-time-series.html"><a href="boostrap-methods-for-time-series.html#exercice-2-lake-erie-and-lake-huron-levels"><i class="fa fa-check"></i><b>3.2.5</b> Exercice 2: Lake Erie and Lake Huron levels</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="generalized-autoregressive-conditional-heteroskedasticity-garch-models-and-extensions.html"><a href="generalized-autoregressive-conditional-heteroskedasticity-garch-models-and-extensions.html"><i class="fa fa-check"></i><b>3.3</b> Generalized Autoregressive Conditional Heteroskedasticity (GARCH) models and extensions</a><ul>
<li class="chapter" data-level="3.3.1" data-path="generalized-autoregressive-conditional-heteroskedasticity-garch-models-and-extensions.html"><a href="generalized-autoregressive-conditional-heteroskedasticity-garch-models-and-extensions.html#predictions"><i class="fa fa-check"></i><b>3.3.1</b> Predictions</a></li>
<li class="chapter" data-level="3.3.2" data-path="generalized-autoregressive-conditional-heteroskedasticity-garch-models-and-extensions.html"><a href="generalized-autoregressive-conditional-heteroskedasticity-garch-models-and-extensions.html#exercice-3-international-business-machines-ibm-stock"><i class="fa fa-check"></i><b>3.3.2</b> Exercice 3: International Business Machines (IBM) stock</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="solutions-to-exercises-2.html"><a href="solutions-to-exercises-2.html"><i class="fa fa-check"></i><b>3.4</b> Solutions to Exercises</a><ul>
<li class="chapter" data-level="3.4.1" data-path="solutions-to-exercises-2.html"><a href="solutions-to-exercises-2.html#exercice-1-nottingham-average-monthly-temperature-and-hong-kong-monthly-exports-1"><i class="fa fa-check"></i><b>3.4.1</b> Exercice 1: Nottingham average monthly temperature and Hong Kong monthly exports</a></li>
<li class="chapter" data-level="3.4.2" data-path="solutions-to-exercises-2.html"><a href="solutions-to-exercises-2.html#exercice-2-lake-erie-and-lake-huron-levels-1"><i class="fa fa-check"></i><b>3.4.2</b> Exercice 2: Lake Erie and Lake Huron levels</a></li>
<li class="chapter" data-level="3.4.3" data-path="solutions-to-exercises-2.html"><a href="solutions-to-exercises-2.html#exercice-3-international-business-machines-ibm-stock-1"><i class="fa fa-check"></i><b>3.4.3</b> Exercice 3: International Business Machines (IBM) stock</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="spectral-analysis-and-filtering.html"><a href="spectral-analysis-and-filtering.html"><i class="fa fa-check"></i><b>4</b> Spectral analysis and filtering</a><ul>
<li class="chapter" data-level="4.1" data-path="nonparametric-spectral-estimation.html"><a href="nonparametric-spectral-estimation.html"><i class="fa fa-check"></i><b>4.1</b> Nonparametric spectral estimation</a><ul>
<li class="chapter" data-level="4.1.1" data-path="nonparametric-spectral-estimation.html"><a href="nonparametric-spectral-estimation.html#a-data-example"><i class="fa fa-check"></i><b>4.1.1</b> A data example</a></li>
<li class="chapter" data-level="4.1.2" data-path="nonparametric-spectral-estimation.html"><a href="nonparametric-spectral-estimation.html#smoothing"><i class="fa fa-check"></i><b>4.1.2</b> Smoothing</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="summary-of-nonparametric-spectral-estimation.html"><a href="summary-of-nonparametric-spectral-estimation.html"><i class="fa fa-check"></i><b>4.2</b> Summary of nonparametric spectral estimation</a></li>
<li class="chapter" data-level="4.3" data-path="spectral-estimation-in-r.html"><a href="spectral-estimation-in-r.html"><i class="fa fa-check"></i><b>4.3</b> Spectral estimation in R</a><ul>
<li class="chapter" data-level="4.3.1" data-path="spectral-estimation-in-r.html"><a href="spectral-estimation-in-r.html#smoothing-and-seasonally-adjusted-values"><i class="fa fa-check"></i><b>4.3.1</b> Smoothing and seasonally adjusted values</a></li>
<li class="chapter" data-level="4.3.2" data-path="spectral-estimation-in-r.html"><a href="spectral-estimation-in-r.html#exercise-1-southern-oscillation-index-soi-and-fish-recruitement"><i class="fa fa-check"></i><b>4.3.2</b> Exercise 1: Southern oscillation index (SOI) and fish recruitement</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="covariates-and-dynamic-linear-models.html"><a href="covariates-and-dynamic-linear-models.html"><i class="fa fa-check"></i><b>5</b> Covariates and dynamic linear models</a><ul>
<li class="chapter" data-level="5.1" data-path="simulation-based-prediction-intervals-for-arima-garch-models.html"><a href="simulation-based-prediction-intervals-for-arima-garch-models.html"><i class="fa fa-check"></i><b>5.1</b> Simulation-based prediction intervals for ARIMA-GARCH models</a></li>
<li class="chapter" data-level="5.2" data-path="state-space-models-and-the-kalman-filter.html"><a href="state-space-models-and-the-kalman-filter.html"><i class="fa fa-check"></i><b>5.2</b> State-space models and the Kalman filter</a><ul>
<li class="chapter" data-level="5.2.1" data-path="state-space-models-and-the-kalman-filter.html"><a href="state-space-models-and-the-kalman-filter.html#exercise-1-dynamic-linear-model-for-the-nile-river-dataset"><i class="fa fa-check"></i><b>5.2.1</b> Exercise 1: Dynamic linear model for the Nile river dataset</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="notes-on-irregular-time-series-and-missing-values.html"><a href="notes-on-irregular-time-series-and-missing-values.html"><i class="fa fa-check"></i><b>6</b> Notes on irregular time series and missing values&quot;</a><ul>
<li class="chapter" data-level="6.1" data-path="irregular-time-series.html"><a href="irregular-time-series.html"><i class="fa fa-check"></i><b>6.1</b> Irregular time series</a><ul>
<li class="chapter" data-level="6.1.1" data-path="irregular-time-series.html"><a href="irregular-time-series.html#exercise-1-jussy-air-temperature"><i class="fa fa-check"></i><b>6.1.1</b> Exercise 1: Jussy air temperature</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="imputation-of-missing-values.html"><a href="imputation-of-missing-values.html"><i class="fa fa-check"></i><b>6.2</b> Imputation of missing values</a><ul>
<li class="chapter" data-level="6.2.1" data-path="imputation-of-missing-values.html"><a href="imputation-of-missing-values.html#exercise-2-tyne-river-flow"><i class="fa fa-check"></i><b>6.2.1</b> Exercise 2: Tyne river flow</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="solutions-to-exercises-3.html"><a href="solutions-to-exercises-3.html"><i class="fa fa-check"></i><b>6.3</b> Solutions to Exercises</a><ul>
<li class="chapter" data-level="6.3.1" data-path="solutions-to-exercises-3.html"><a href="solutions-to-exercises-3.html#exercise-1-jussy-air-temperature-1"><i class="fa fa-check"></i><b>6.3.1</b> Exercise 1: Jussy air temperature</a></li>
<li class="chapter" data-level="6.3.2" data-path="solutions-to-exercises-3.html"><a href="solutions-to-exercises-3.html#exercise-2-tyne-river-flow-1"><i class="fa fa-check"></i><b>6.3.2</b> Exercise 2: Tyne river flow</a></li>
</ul></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">timeseRies</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="simulation-based-prediction-intervals-for-arima-garch-models" class="section level2">
<h2><span class="header-section-number">5.1</span> Simulation-based prediction intervals for ARIMA-GARCH models</h2>
<p>In many cases, residuals from SARIMA models exhibit stochastic volatility (the variance is not constant).
Since there is no function (to the best of my knowledge) to fit a SARIMA-GARCH model, you can do so in multiple steps. That is, first first your SARIMA and use the residuals from the latter and plug-them as data for your GARCH model. The point estimates will be consistent and asymptotically normal, but the standard errors are incorrect and need to be adjusted (one uses so-called <strong>robust standard errors</strong>). Since the confidence intervals from <code>arima</code> are normal confidence intervals, you will need to adjust them manually. The following recipe can help you get prediction intervals manually by means of simulation.</p>
<p>The <span class="math inline">\(h\)</span>-step ahead forecasts are best linear predictors, meaning they are fixed. An alternative is to simulate trajectories from the fitted models conditional on the observed past and use the latter to obtain prediction intervals. It is crucial to take into account previous errors and observations so that our simulations make sense.</p>
<p>To generate <span class="math inline">\(K\)</span> step ahead forecasts from an ARIMA-GARCH model:</p>
<ol style="list-style-type: decimal">
<li>Let <span class="math inline">\(v_t=\varepsilon_t\sigma_t\)</span> and <span class="math inline">\(\varepsilon \sim F(0, 1)\)</span>, where <span class="math inline">\(F\)</span> is e.g. a Normal or a Student-<span class="math inline">\(t\)</span> distribution.
Generate GARCH innovations based on <span class="math inline">\(\widehat{v}_{1:n}\)</span> and <span class="math inline">\(\widehat{\sigma}_{1:n}\)</span>, estimating <span class="math inline">\({\sigma}_{n+1}^{n}\)</span> using the GARCH recursions and sampling <span class="math inline">\(\varepsilon_t\)</span>, form a new variable <span class="math inline">\(\widetilde{v}_{n+1} = {\sigma}_{n+1}^{n}\varepsilon_{n+1}\)</span>. Iterate <span class="math inline">\(K+d\)</span> times, where <span class="math inline">\(d\)</span> is the number of differences.</li>
<li>Pass to <code>arima.sim</code> the following arguments</li>
</ol>
<ul>
<li><code>model</code>: a list or the output of <code>arima</code> or variant thereof</li>
<li><code>n</code>: the integer <span class="math inline">\(K+d\)</span></li>
<li><code>innov</code>: the simulated series <span class="math inline">\(\widetilde{v}_{n+1}, \ldots, \widetilde{v}_{n+K}\)</span> as</li>
<li><code>start.innov</code>: the vector of residuals <span class="math inline">\(\widehat{v}_{1:n}\)</span>.</li>
<li><code>n.start</code>: the integer <span class="math inline">\(n-1\)</span>.</li>
</ul>
<p>The function will thus return a time series drawn from your fitted ARIMA-GARCH model. Replicate this procedure <span class="math inline">\(B=1000\)</span> times, say, then use as pointwise prediction intervals the 95% confidence interval based on the simulated values with rank 25 and 975. You could use the mean or median of the simulated trajectory as point forecast.</p>
<p>If you use <code>fGarch</code> package, the model adjusts for the distribution and for your ARMA-GARCH model; see the help in <code>?'predict,fGARCH-method'</code>.</p>
<p>If you wish to fit the ARIMA-GARCH jointly, but try to constrain some parameters to mimic a SARIMA model, this is also possible using the <code>rugarch</code> package by fixing some of values of <span class="math inline">\(\boldsymbol{\theta}, \boldsymbol{\phi}\)</span> to zero. Note that the optimization in <code>rugarch</code> will then often fail because the fit from the <code>arima</code> part is not stationary. Fixing parameters allows one to only estimate a handful of parameters.</p>
<p>Here is an example using monthly temperatures. Fitting an ARIMA without constraints with the same specification would require estimating 28 additional ARMA parameters.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(rugarch)
<span class="co"># Mean monthly temperature in UK, from Hadley center</span>
<span class="kw">data</span>(CETmonthly, <span class="dt">package =</span> <span class="st">&quot;multitaper&quot;</span>)
<span class="co"># Keep period 1900-2000</span>
mtempfull &lt;-<span class="st"> </span><span class="kw">ts</span>(CETmonthly[, <span class="dv">3</span>], <span class="dt">start =</span> <span class="kw">c</span>(CETmonthly[<span class="dv">1</span>, <span class="dv">1</span>], CETmonthly[<span class="dv">1</span>, <span class="dv">2</span>]), 
    <span class="dt">frequency =</span> <span class="dv">12</span>)
mtemp &lt;-<span class="st"> </span><span class="kw">window</span>(mtempfull, <span class="dt">start =</span> <span class="kw">c</span>(<span class="dv">1900</span>, <span class="dv">1</span>), <span class="dt">end =</span> <span class="kw">c</span>(<span class="dv">1999</span>, <span class="dv">12</span>))
months &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">12</span>, <span class="dv">100</span>)
<span class="co"># Fit our favorite model - Fourier basis + SARMA(1,0,1)x(1,0,1)</span>
meanreg &lt;-<span class="st"> </span><span class="kw">cbind</span>(<span class="kw">cos</span>(<span class="dv">2</span> <span class="op">*</span><span class="st"> </span>pi <span class="op">*</span><span class="st"> </span>months<span class="op">/</span><span class="dv">12</span>), <span class="kw">sin</span>(<span class="dv">2</span> <span class="op">*</span><span class="st"> </span>pi <span class="op">*</span><span class="st"> </span>months<span class="op">/</span><span class="dv">12</span>), <span class="kw">cos</span>(<span class="dv">4</span> <span class="op">*</span><span class="st"> </span>pi <span class="op">*</span><span class="st"> </span>
<span class="st">    </span>months<span class="op">/</span><span class="dv">12</span>), <span class="kw">sin</span>(<span class="dv">4</span> <span class="op">*</span><span class="st"> </span>pi <span class="op">*</span><span class="st"> </span>months<span class="op">/</span><span class="dv">12</span>))
sarima &lt;-<span class="st"> </span>forecast<span class="op">::</span><span class="kw">Arima</span>(mtemp, <span class="dt">order =</span> <span class="kw">c</span>(<span class="dv">3</span>, <span class="dv">0</span>, <span class="dv">1</span>), <span class="dt">seasonal =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>), 
    <span class="dt">xreg =</span> meanreg)
<span class="co"># Not great, but will serve for the illustration</span>

<span class="co"># This SARIMA is basically an ARMA model of high order with constraints</span>
<span class="co"># These constraints can be roughly replicated by fixing most components to</span>
<span class="co"># zero For example, if we have a SARMA (0,1)x(0,1)[12], coefficients 2 to 11</span>
<span class="co"># are zero We will however estimate an extra MA parameter at lag 13 which</span>
<span class="co"># would normally be prod(sarima$model$theta[c(1,12)])</span>

<span class="co"># Extract AR coefficients via $model$phi Extract MA coefficients via</span>
<span class="co"># $model$theta Find which parameters are zero and constrain them</span>
lnames &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">paste0</span>(<span class="st">&quot;ar&quot;</span>, <span class="kw">which</span>(<span class="kw">sapply</span>(sarima<span class="op">$</span>model<span class="op">$</span>phi, <span class="cf">function</span>(th) {
    <span class="kw">isTRUE</span>(<span class="kw">all.equal</span>(th, <span class="dv">0</span>))
}))), <span class="kw">paste0</span>(<span class="st">&quot;ma&quot;</span>, <span class="kw">which</span>(<span class="kw">sapply</span>(sarima<span class="op">$</span>model<span class="op">$</span>theta, <span class="cf">function</span>(th) {
    <span class="kw">isTRUE</span>(<span class="kw">all.equal</span>(th, <span class="dv">0</span>))
}))))
constraints &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="kw">list</span>(<span class="dv">0</span>), <span class="kw">length</span>(lnames))
<span class="kw">names</span>(constraints) &lt;-<span class="st"> </span>lnames
order &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">length</span>(sarima<span class="op">$</span>model<span class="op">$</span>phi), <span class="kw">length</span>(sarima<span class="op">$</span>model<span class="op">$</span>theta))

<span class="co"># To have a non-constant variance, we can let it vary per month Could try</span>
<span class="co"># with dummies, but will stick with Fourier (issues with convergence of</span>
<span class="co"># optimization routine otherwise) Creating a matrix of dummies varreg &lt;-</span>
<span class="co"># model.matrix(lm(months~as.factor(months)))[,-1] Model specification</span>
model &lt;-<span class="st"> </span><span class="kw">ugarchspec</span>(<span class="dt">variance.model =</span> <span class="kw">list</span>(<span class="dt">model =</span> <span class="st">&quot;eGARCH&quot;</span>, <span class="dt">garchOrder =</span> <span class="kw">c</span>(<span class="dv">0</span>, 
    <span class="dv">0</span>), <span class="dt">external.regressors =</span> meanreg), <span class="dt">mean.model =</span> <span class="kw">list</span>(<span class="dt">armaOrder =</span> order, 
    <span class="dt">include.mean =</span> <span class="ot">TRUE</span>, <span class="dt">external.regressors =</span> meanreg), <span class="dt">distribution.model =</span> <span class="st">&quot;std&quot;</span>, 
    <span class="dt">fixed.pars =</span> constraints)
<span class="co"># Fit model</span>
fitmodel &lt;-<span class="st"> </span><span class="kw">ugarchfit</span>(<span class="dt">spec =</span> model, <span class="dt">data =</span> mtemp)
<span class="co"># Coefficients of the model</span>
fitmodel<span class="op">@</span>fit<span class="op">$</span>coef[fitmodel<span class="op">@</span>fit<span class="op">$</span>coef <span class="op">!=</span><span class="st"> </span><span class="dv">0</span>]</code></pre>
<pre><code>          mu          ar1          ar2          ar3         ar12 
 9.133351478  0.810482688 -0.082144383 -0.006738789 -0.403624702 
        ar13         ar14         ar15          ma1         ma12 
 0.903950549 -0.179310483 -0.034706531 -0.608517750  0.429732865 
        ma13       mxreg1       mxreg2       mxreg3       mxreg4 
-0.804101668 -4.870149150 -3.902274279 -0.111705243  0.515741055 
       omega       vxreg1       vxreg2       vxreg3       vxreg4 
 0.439684060  0.442367489  0.298552838  0.110085160  0.236309381 
       shape 
65.572523216 </code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Not parsimonious, but all coefficients are significant</span>

<span class="co"># Forecast K observations ahead</span>
plotforecasted &lt;-<span class="st"> </span><span class="cf">function</span>(<span class="dt">m =</span> <span class="dv">60</span>) {
    <span class="co"># Here, the variance depends only on the monthly index - deterministic</span>
    <span class="co"># variation</span>
    sig &lt;-<span class="st"> </span><span class="kw">sqrt</span>(<span class="kw">exp</span>(fitmodel<span class="op">@</span>fit<span class="op">$</span>coef[<span class="st">&quot;omega&quot;</span>] <span class="op">+</span><span class="st"> </span>meanreg[<span class="dv">1</span><span class="op">:</span>m, ] <span class="op">%*%</span><span class="st"> </span><span class="kw">coef</span>(fitmodel)[<span class="kw">startsWith</span>(<span class="dt">prefix =</span> <span class="st">&quot;vxreg&quot;</span>, 
        <span class="kw">names</span>(<span class="kw">coef</span>(fitmodel)))]))
    arma_par &lt;-<span class="st"> </span><span class="kw">coef</span>(fitmodel)[<span class="kw">as.logical</span>(<span class="kw">startsWith</span>(<span class="st">&quot;ar&quot;</span>, <span class="dt">x =</span> <span class="kw">names</span>(fitmodel<span class="op">@</span>fit<span class="op">$</span>coef)) <span class="op">+</span><span class="st"> </span>
<span class="st">        </span><span class="kw">startsWith</span>(<span class="st">&quot;ma&quot;</span>, <span class="dt">x =</span> <span class="kw">names</span>(fitmodel<span class="op">@</span>fit<span class="op">$</span>coef)))]
    <span class="co"># Generate replications from the ARIMA model and add the deterministic part</span>
    simu_paths &lt;-<span class="st"> </span><span class="kw">replicate</span>(<span class="kw">c</span>(<span class="kw">arima.sim</span>(<span class="dt">model =</span> <span class="kw">as.list</span>(arma_par), <span class="dt">n =</span> m, <span class="dt">innov =</span> sig <span class="op">*</span><span class="st"> </span>
<span class="st">        </span><span class="kw">rt</span>(m, <span class="dt">df =</span> fitmodel<span class="op">@</span>fit<span class="op">$</span>coef[<span class="st">&quot;shape&quot;</span>]), <span class="dt">start.innov =</span> <span class="kw">as.vector</span>(<span class="kw">residuals</span>(fitmodel)), 
        <span class="dt">n.start =</span> <span class="kw">length</span>(<span class="kw">residuals</span>(fitmodel)) <span class="op">-</span><span class="st"> </span><span class="dv">1</span>) <span class="op">+</span><span class="st"> </span>meanreg[<span class="dv">1</span><span class="op">:</span>m, ] <span class="op">%*%</span><span class="st"> </span><span class="kw">coef</span>(fitmodel)[<span class="kw">startsWith</span>(<span class="st">&quot;mxreg&quot;</span>, 
        <span class="dt">x =</span> <span class="kw">names</span>(fitmodel<span class="op">@</span>fit<span class="op">$</span>coef))] <span class="op">+</span><span class="st"> </span><span class="kw">coef</span>(fitmodel)[<span class="dv">1</span>]), <span class="dt">n =</span> <span class="dv">1000</span>)
    <span class="co"># Extract the sample quantiles from the Monte-Carlo replications of the</span>
    <span class="co"># paths</span>
    confinter &lt;-<span class="st"> </span><span class="kw">apply</span>(simu_paths, <span class="dv">1</span>, <span class="cf">function</span>(x) {
        <span class="kw">quantile</span>(x, <span class="kw">c</span>(<span class="fl">0.05</span>, <span class="fl">0.5</span>, <span class="fl">0.95</span>))
    })
    <span class="co"># Plot the series with previous years</span>
    <span class="kw">plot</span>(<span class="kw">window</span>(mtempfull, <span class="dt">start =</span> <span class="kw">c</span>(<span class="dv">1996</span>, <span class="dv">1</span>)), <span class="dt">xlim =</span> <span class="kw">c</span>(<span class="dv">1996</span>, m<span class="op">/</span><span class="dv">12</span> <span class="op">+</span><span class="st"> </span><span class="dv">2000</span> <span class="op">-</span><span class="st"> </span>
<span class="st">        </span><span class="fl">0.5</span>), <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">20</span>), <span class="dt">main =</span> <span class="st">&quot;Central England monthly temperatures&quot;</span>, 
        <span class="dt">ylab =</span> <span class="st">&quot;Degrees Celsius&quot;</span>, <span class="dt">bty =</span> <span class="st">&quot;l&quot;</span>)
    <span class="co"># Add forecasts with 90% confidence intervals</span>
    <span class="kw">matplot</span>(<span class="dt">x =</span> <span class="kw">seq</span>(<span class="dv">2000</span> <span class="op">+</span><span class="st"> </span><span class="dv">1</span><span class="op">/</span><span class="dv">12</span>, <span class="dt">by =</span> <span class="dv">1</span><span class="op">/</span><span class="dv">12</span>, <span class="dt">length.out =</span> m), <span class="dt">y =</span> <span class="kw">t</span>(confinter), 
        <span class="dt">lty =</span> <span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">2</span>), <span class="dt">lwd =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">1</span>), <span class="dt">type =</span> <span class="kw">rep</span>(<span class="st">&quot;l&quot;</span>, <span class="dv">3</span>), <span class="dt">col =</span> <span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">1</span>, 
            <span class="dv">2</span>), <span class="dt">add =</span> <span class="ot">TRUE</span>)
}

<span class="co"># Plot the forecasts</span>
<span class="kw">plotforecasted</span>(<span class="dv">120</span>)</code></pre>
<p><img src="timeseRies_files/figure-html/temperature-1.png" width="672" /></p>
<p>In this specific example, since the variance is not autoregressive and depends only on covariates, we need not simulate paths conditional on the last observed values of <span class="math inline">\(\widehat{v}_t\)</span>.</p>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="covariates-and-dynamic-linear-models.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="state-space-models-and-the-kalman-filter.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"download": ["timeseRies.pdf", "timeseRies.epub"],
"toc": {
"collapse": "none"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdn.bootcss.com/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(src))
      src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
