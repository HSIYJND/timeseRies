<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>timeseRies</title>
  <meta name="description" content="This is a web complement to MATH 342 (Time series) given at EPFL.">
  <meta name="generator" content="bookdown  and GitBook 2.6.7">

  <meta property="og:title" content="timeseRies" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This is a web complement to MATH 342 (Time series) given at EPFL." />
  <meta name="github-repo" content="lbelzile/timeseRies" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="timeseRies" />
  
  <meta name="twitter:description" content="This is a web complement to MATH 342 (Time series) given at EPFL." />
  

<meta name="author" content="Léo Belzile">



  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="manual-maximum-likelihood-estimation.html">
<link rel="next" href="information-criterion-model-selection-and-profile-likelihood.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; background-color: #f8f8f8; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
pre, code { background-color: #f8f8f8; }
code > span.kw { color: #204a87; font-weight: bold; } /* Keyword */
code > span.dt { color: #204a87; } /* DataType */
code > span.dv { color: #0000cf; } /* DecVal */
code > span.bn { color: #0000cf; } /* BaseN */
code > span.fl { color: #0000cf; } /* Float */
code > span.ch { color: #4e9a06; } /* Char */
code > span.st { color: #4e9a06; } /* String */
code > span.co { color: #8f5902; font-style: italic; } /* Comment */
code > span.ot { color: #8f5902; } /* Other */
code > span.al { color: #ef2929; } /* Alert */
code > span.fu { color: #000000; } /* Function */
code > span.er { color: #a40000; font-weight: bold; } /* Error */
code > span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #000000; } /* Constant */
code > span.sc { color: #000000; } /* SpecialChar */
code > span.vs { color: #4e9a06; } /* VerbatimString */
code > span.ss { color: #4e9a06; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #000000; } /* Variable */
code > span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
code > span.op { color: #ce5c00; font-weight: bold; } /* Operator */
code > span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
code > span.ex { } /* Extension */
code > span.at { color: #c4a000; } /* Attribute */
code > span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
code > span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
</style>

<link rel="stylesheet" href="css/style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Time Series</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preliminary remarks</a></li>
<li class="chapter" data-level="1" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i><b>1</b> Introduction</a><ul>
<li class="chapter" data-level="1.1" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html"><i class="fa fa-check"></i><b>1.1</b> Exploratory Data Analysis</a><ul>
<li class="chapter" data-level="1.1.1" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html#libraries"><i class="fa fa-check"></i><b>1.1.1</b> Libraries</a></li>
<li class="chapter" data-level="1.1.2" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html#loading-datasets"><i class="fa fa-check"></i><b>1.1.2</b> Loading datasets</a></li>
<li class="chapter" data-level="1.1.3" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html#time-series-objects-and-basic-plots"><i class="fa fa-check"></i><b>1.1.3</b> Time series objects and basic plots</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="introduction-to-the-basic-time-series-functions.html"><a href="introduction-to-the-basic-time-series-functions.html"><i class="fa fa-check"></i><b>1.2</b> Introduction to the basic time series functions</a><ul>
<li class="chapter" data-level="1.2.1" data-path="introduction-to-the-basic-time-series-functions.html"><a href="introduction-to-the-basic-time-series-functions.html#exercise-1-beaver-temperature"><i class="fa fa-check"></i><b>1.2.1</b> Exercise 1: Beaver temperature</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="second-order-stationarity.html"><a href="second-order-stationarity.html"><i class="fa fa-check"></i><b>1.3</b> Second order stationarity</a><ul>
<li class="chapter" data-level="1.3.1" data-path="second-order-stationarity.html"><a href="second-order-stationarity.html#exercise-2-sp500-daily-returns"><i class="fa fa-check"></i><b>1.3.1</b> Exercise 2: SP500 daily returns</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="simulations.html"><a href="simulations.html"><i class="fa fa-check"></i><b>1.4</b> Simulations</a><ul>
<li class="chapter" data-level="1.4.1" data-path="simulations.html"><a href="simulations.html#exercise-3-simulated-data"><i class="fa fa-check"></i><b>1.4.1</b> Exercise 3: Simulated data</a></li>
</ul></li>
<li class="chapter" data-level="1.5" data-path="spectral-analysis.html"><a href="spectral-analysis.html"><i class="fa fa-check"></i><b>1.5</b> Spectral analysis</a></li>
<li class="chapter" data-level="1.6" data-path="smoothing-and-detrending.html"><a href="smoothing-and-detrending.html"><i class="fa fa-check"></i><b>1.6</b> Smoothing and detrending</a><ul>
<li class="chapter" data-level="1.6.1" data-path="smoothing-and-detrending.html"><a href="smoothing-and-detrending.html#exercise-4-mauna-loa-atmospheric-co2-concentration"><i class="fa fa-check"></i><b>1.6.1</b> Exercise 4: Mauna Loa Atmospheric CO<sub>2</sub> Concentration</a></li>
</ul></li>
<li class="chapter" data-level="1.7" data-path="solutions-to-exercises.html"><a href="solutions-to-exercises.html"><i class="fa fa-check"></i><b>1.7</b> Solutions to Exercises</a><ul>
<li class="chapter" data-level="1.7.1" data-path="solutions-to-exercises.html"><a href="solutions-to-exercises.html#solutions-1-beaver-temperature"><i class="fa fa-check"></i><b>1.7.1</b> Solutions 1: Beaver temperature</a></li>
<li class="chapter" data-level="1.7.2" data-path="solutions-to-exercises.html"><a href="solutions-to-exercises.html#solutions-2-sp500-daily-returns"><i class="fa fa-check"></i><b>1.7.2</b> Solutions 2: SP500 daily returns</a></li>
<li class="chapter" data-level="1.7.3" data-path="solutions-to-exercises.html"><a href="solutions-to-exercises.html#solutions-3-simulated-data"><i class="fa fa-check"></i><b>1.7.3</b> Solutions 3: Simulated data</a></li>
<li class="chapter" data-level="1.7.4" data-path="solutions-to-exercises.html"><a href="solutions-to-exercises.html#solutions-4-mauna-loa-atmospheric-co2-concentration"><i class="fa fa-check"></i><b>1.7.4</b> Solutions 4: Mauna Loa Atmospheric CO<sub>2</sub> Concentration</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="likelihood-estimation-and-the-boxjenkins-method.html"><a href="likelihood-estimation-and-the-boxjenkins-method.html"><i class="fa fa-check"></i><b>2</b> Likelihood estimation and the Box–Jenkins method</a><ul>
<li class="chapter" data-level="2.1" data-path="manual-maximum-likelihood-estimation.html"><a href="manual-maximum-likelihood-estimation.html"><i class="fa fa-check"></i><b>2.1</b> Manual maximum likelihood estimation</a><ul>
<li class="chapter" data-level="2.1.1" data-path="manual-maximum-likelihood-estimation.html"><a href="manual-maximum-likelihood-estimation.html#exercise-1-ubs-stock-returns"><i class="fa fa-check"></i><b>2.1.1</b> Exercise 1: UBS stock returns</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="boxjenkins-methodology-for-arma-models.html"><a href="boxjenkins-methodology-for-arma-models.html"><i class="fa fa-check"></i><b>2.2</b> Box–Jenkins methodology for ARMA models</a><ul>
<li class="chapter" data-level="2.2.1" data-path="boxjenkins-methodology-for-arma-models.html"><a href="boxjenkins-methodology-for-arma-models.html#exercise-2-simulated-series"><i class="fa fa-check"></i><b>2.2.1</b> Exercise 2: Simulated series</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="information-criterion-model-selection-and-profile-likelihood.html"><a href="information-criterion-model-selection-and-profile-likelihood.html"><i class="fa fa-check"></i><b>2.3</b> Information criterion, model selection and profile likelihood</a><ul>
<li class="chapter" data-level="2.3.1" data-path="information-criterion-model-selection-and-profile-likelihood.html"><a href="information-criterion-model-selection-and-profile-likelihood.html#exercise-3-lake-erie-height"><i class="fa fa-check"></i><b>2.3.1</b> Exercise 3: Lake Erie height</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="solutions-to-exercises-1.html"><a href="solutions-to-exercises-1.html"><i class="fa fa-check"></i><b>2.4</b> Solutions to Exercises</a><ul>
<li class="chapter" data-level="2.4.1" data-path="solutions-to-exercises-1.html"><a href="solutions-to-exercises-1.html#exercise-1-ubs-stock-returns-1"><i class="fa fa-check"></i><b>2.4.1</b> Exercise 1: UBS stock returns</a></li>
<li class="chapter" data-level="2.4.2" data-path="solutions-to-exercises-1.html"><a href="solutions-to-exercises-1.html#exercise-2-simulated-series-1"><i class="fa fa-check"></i><b>2.4.2</b> Exercise 2: Simulated series</a></li>
<li class="chapter" data-level="2.4.3" data-path="solutions-to-exercises-1.html"><a href="solutions-to-exercises-1.html#exercise-3-lake-erie-height-1"><i class="fa fa-check"></i><b>2.4.3</b> Exercise 3: Lake Erie height</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="seasonal-arima-and-garch-models.html"><a href="seasonal-arima-and-garch-models.html"><i class="fa fa-check"></i><b>3</b> Seasonal ARIMA and GARCH models</a><ul>
<li class="chapter" data-level="3.1" data-path="sarima-models-estimation-and-forecasting.html"><a href="sarima-models-estimation-and-forecasting.html"><i class="fa fa-check"></i><b>3.1</b> SARIMA models: estimation and forecasting</a></li>
<li class="chapter" data-level="3.2" data-path="an-aside-on-models-with-regressors-optional.html"><a href="an-aside-on-models-with-regressors-optional.html"><i class="fa fa-check"></i><b>3.2</b> An aside on models with regressors (optional)</a><ul>
<li class="chapter" data-level="3.2.1" data-path="an-aside-on-models-with-regressors-optional.html"><a href="an-aside-on-models-with-regressors-optional.html#mauna-loa-co2-dataset"><i class="fa fa-check"></i><b>3.2.1</b> Mauna Loa CO<sub>2</sub> dataset</a></li>
<li class="chapter" data-level="3.2.2" data-path="an-aside-on-models-with-regressors-optional.html"><a href="an-aside-on-models-with-regressors-optional.html#exercice-1-nottingham-average-monthly-temperature-and-hong-kong-monthly-exports"><i class="fa fa-check"></i><b>3.2.2</b> Exercice 1: Nottingham average monthly temperature and Hong Kong monthly exports</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="boostrap-methods-for-time-series.html"><a href="boostrap-methods-for-time-series.html"><i class="fa fa-check"></i><b>3.3</b> Boostrap methods for time series</a><ul>
<li class="chapter" data-level="3.3.1" data-path="boostrap-methods-for-time-series.html"><a href="boostrap-methods-for-time-series.html#bootstrapping-a-linear-model"><i class="fa fa-check"></i><b>3.3.1</b> Bootstrapping a linear model</a></li>
<li class="chapter" data-level="3.3.2" data-path="boostrap-methods-for-time-series.html"><a href="boostrap-methods-for-time-series.html#testing-for-heteroscedasticity"><i class="fa fa-check"></i><b>3.3.2</b> Testing for heteroscedasticity</a></li>
<li class="chapter" data-level="3.3.3" data-path="boostrap-methods-for-time-series.html"><a href="boostrap-methods-for-time-series.html#ar-sieve-bootstrap"><i class="fa fa-check"></i><b>3.3.3</b> AR-sieve bootstrap</a></li>
<li class="chapter" data-level="3.3.4" data-path="boostrap-methods-for-time-series.html"><a href="boostrap-methods-for-time-series.html#boostrap-models-for-uncertainty-assesment"><i class="fa fa-check"></i><b>3.3.4</b> Boostrap models for uncertainty assesment</a></li>
<li class="chapter" data-level="3.3.5" data-path="boostrap-methods-for-time-series.html"><a href="boostrap-methods-for-time-series.html#exercice-2-lake-erie-and-lake-huron-levels"><i class="fa fa-check"></i><b>3.3.5</b> Exercice 2: Lake Erie and Lake Huron levels</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="generalized-autoregressive-conditional-heteroskedasticity-garch-models-and-extensions.html"><a href="generalized-autoregressive-conditional-heteroskedasticity-garch-models-and-extensions.html"><i class="fa fa-check"></i><b>3.4</b> Generalized Autoregressive Conditional Heteroskedasticity (GARCH) models and extensions</a><ul>
<li class="chapter" data-level="3.4.1" data-path="generalized-autoregressive-conditional-heteroskedasticity-garch-models-and-extensions.html"><a href="generalized-autoregressive-conditional-heteroskedasticity-garch-models-and-extensions.html#predictions"><i class="fa fa-check"></i><b>3.4.1</b> Predictions</a></li>
<li class="chapter" data-level="3.4.2" data-path="generalized-autoregressive-conditional-heteroskedasticity-garch-models-and-extensions.html"><a href="generalized-autoregressive-conditional-heteroskedasticity-garch-models-and-extensions.html#exercice-3-international-business-machines-ibm-stock"><i class="fa fa-check"></i><b>3.4.2</b> Exercice 3: International Business Machines (IBM) stock</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="solutions-to-exercises-2.html"><a href="solutions-to-exercises-2.html"><i class="fa fa-check"></i><b>3.5</b> Solutions to Exercises</a><ul>
<li class="chapter" data-level="3.5.1" data-path="solutions-to-exercises-2.html"><a href="solutions-to-exercises-2.html#exercice-1-nottingham-average-monthly-temperature-and-hong-kong-monthly-exports-1"><i class="fa fa-check"></i><b>3.5.1</b> Exercice 1: Nottingham average monthly temperature and Hong Kong monthly exports</a></li>
<li class="chapter" data-level="3.5.2" data-path="solutions-to-exercises-2.html"><a href="solutions-to-exercises-2.html#exercice-2-lake-erie-and-lake-huron-levels-1"><i class="fa fa-check"></i><b>3.5.2</b> Exercice 2: Lake Erie and Lake Huron levels</a></li>
<li class="chapter" data-level="3.5.3" data-path="solutions-to-exercises-2.html"><a href="solutions-to-exercises-2.html#exercice-3-international-business-machines-ibm-stock-1"><i class="fa fa-check"></i><b>3.5.3</b> Exercice 3: International Business Machines (IBM) stock</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="spectral-analysis-and-filtering.html"><a href="spectral-analysis-and-filtering.html"><i class="fa fa-check"></i><b>4</b> Spectral analysis and filtering</a><ul>
<li class="chapter" data-level="4.1" data-path="nonparametric-spectral-estimation.html"><a href="nonparametric-spectral-estimation.html"><i class="fa fa-check"></i><b>4.1</b> Nonparametric spectral estimation</a><ul>
<li class="chapter" data-level="4.1.1" data-path="nonparametric-spectral-estimation.html"><a href="nonparametric-spectral-estimation.html#tapering"><i class="fa fa-check"></i><b>4.1.1</b> Tapering</a></li>
<li class="chapter" data-level="4.1.2" data-path="nonparametric-spectral-estimation.html"><a href="nonparametric-spectral-estimation.html#a-data-example"><i class="fa fa-check"></i><b>4.1.2</b> A data example</a></li>
<li class="chapter" data-level="4.1.3" data-path="nonparametric-spectral-estimation.html"><a href="nonparametric-spectral-estimation.html#smoothing"><i class="fa fa-check"></i><b>4.1.3</b> Smoothing</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="summary-of-nonparametric-spectral-estimation.html"><a href="summary-of-nonparametric-spectral-estimation.html"><i class="fa fa-check"></i><b>4.2</b> Summary of nonparametric spectral estimation</a></li>
<li class="chapter" data-level="4.3" data-path="spectral-estimation-in-r.html"><a href="spectral-estimation-in-r.html"><i class="fa fa-check"></i><b>4.3</b> Spectral estimation in R</a><ul>
<li class="chapter" data-level="4.3.1" data-path="spectral-estimation-in-r.html"><a href="spectral-estimation-in-r.html#smoothing-and-seasonally-adjusted-values"><i class="fa fa-check"></i><b>4.3.1</b> Smoothing and seasonally adjusted values</a></li>
<li class="chapter" data-level="4.3.2" data-path="spectral-estimation-in-r.html"><a href="spectral-estimation-in-r.html#exercise-1-southern-oscillation-index-soi-and-fish-recruitement"><i class="fa fa-check"></i><b>4.3.2</b> Exercise 1: Southern oscillation index (SOI) and fish recruitement</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="covariates-and-dynamic-linear-models.html"><a href="covariates-and-dynamic-linear-models.html"><i class="fa fa-check"></i><b>5</b> Covariates and dynamic linear models</a><ul>
<li class="chapter" data-level="5.1" data-path="simulation-based-prediction-intervals-for-arima-garch-models.html"><a href="simulation-based-prediction-intervals-for-arima-garch-models.html"><i class="fa fa-check"></i><b>5.1</b> Simulation-based prediction intervals for ARIMA-GARCH models</a></li>
<li class="chapter" data-level="5.2" data-path="state-space-models-and-the-kalman-filter.html"><a href="state-space-models-and-the-kalman-filter.html"><i class="fa fa-check"></i><b>5.2</b> State-space models and the Kalman filter</a><ul>
<li class="chapter" data-level="5.2.1" data-path="state-space-models-and-the-kalman-filter.html"><a href="state-space-models-and-the-kalman-filter.html#exercise-1-dynamic-linear-model-for-the-nile-river-dataset"><i class="fa fa-check"></i><b>5.2.1</b> Exercise 1: Dynamic linear model for the Nile river dataset</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="notes-on-irregular-time-series-and-missing-values.html"><a href="notes-on-irregular-time-series-and-missing-values.html"><i class="fa fa-check"></i><b>6</b> Notes on irregular time series and missing values&quot;</a><ul>
<li class="chapter" data-level="6.1" data-path="irregular-time-series.html"><a href="irregular-time-series.html"><i class="fa fa-check"></i><b>6.1</b> Irregular time series</a><ul>
<li class="chapter" data-level="6.1.1" data-path="irregular-time-series.html"><a href="irregular-time-series.html#exercise-1-jussy-air-temperature"><i class="fa fa-check"></i><b>6.1.1</b> Exercise 1: Jussy air temperature</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="imputation-of-missing-values.html"><a href="imputation-of-missing-values.html"><i class="fa fa-check"></i><b>6.2</b> Imputation of missing values</a></li>
<li class="chapter" data-level="6.3" data-path="diagnostics-for-missing-values-and-smoothing.html"><a href="diagnostics-for-missing-values-and-smoothing.html"><i class="fa fa-check"></i><b>6.3</b> Diagnostics for missing values and smoothing</a><ul>
<li class="chapter" data-level="6.3.1" data-path="diagnostics-for-missing-values-and-smoothing.html"><a href="diagnostics-for-missing-values-and-smoothing.html#exercise-2-tyne-river-flow"><i class="fa fa-check"></i><b>6.3.1</b> Exercise 2: Tyne river flow</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="solutions-to-exercises-3.html"><a href="solutions-to-exercises-3.html"><i class="fa fa-check"></i><b>6.4</b> Solutions to Exercises</a><ul>
<li class="chapter" data-level="6.4.1" data-path="solutions-to-exercises-3.html"><a href="solutions-to-exercises-3.html#exercise-1-jussy-air-temperature-1"><i class="fa fa-check"></i><b>6.4.1</b> Exercise 1: Jussy air temperature</a></li>
<li class="chapter" data-level="6.4.2" data-path="solutions-to-exercises-3.html"><a href="solutions-to-exercises-3.html#exercise-2-tyne-river-flow-1"><i class="fa fa-check"></i><b>6.4.2</b> Exercise 2: Tyne river flow</a></li>
</ul></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">timeseRies</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="boxjenkins-methodology-for-arma-models" class="section level2">
<h2><span class="header-section-number">2.2</span> Box–Jenkins methodology for ARMA models</h2>
<p>The Wold decomposition theorem states that any second-order stationary time series can be represented as a deterministic process and a stochastic linear process, which can be represented as a causal MA(<span class="math inline">\(\infty\)</span>) series of the form <span class="math display">\[Y_t = \sum_{j = 0}^\infty \psi_j\varepsilon_{t-j}, \qquad \varepsilon_t \sim \mathrm{WN}(0, \sigma^2),\quad \psi_0 = 1, \quad\sum_{j = 0}^\infty \psi_j^2 &lt; \infty\]</span></p>
<p>This does provide a justification for using an ARMA model for modelling. The latter may not be parsimonious nor useful at characterizing the data generating mechanism, but they nevertheless provide in some simple cases a good approximation.</p>
<p>The Box–Jenkins methodology for ARMA models (dating back to time where computing ressources were scarce) allows one to select the order of an AR(<span class="math inline">\(p\)</span>), MA(<span class="math inline">\(q\)</span>) or ARMA(<span class="math inline">\(p, q\)</span>) by visual inspection of the (partial) correlograms. Both should always go alongside one another.</p>
<ol style="list-style-type: decimal">
<li>Apply a transformation of the data <span class="math inline">\(X_t\)</span> where appropriate</li>
</ol>
<ul>
<li>logarithm, Box–Cox transform</li>
<li>differencing so that the series appears linear.</li>
</ul>
<ol start="2" style="list-style-type: decimal">
<li>Correlogram</li>
</ol>
<ul>
<li>Determine the MA(<span class="math inline">\(q\)</span>) order by looking at the autocorrelation, at the points for which <span class="math inline">\(\rho_k \neq 0\)</span> for <span class="math inline">\(k \leq q\)</span> and <span class="math inline">\(r_k \approx 0\)</span> for <span class="math inline">\(k&gt;q\)</span>.</li>
<li>For an AR(<span class="math inline">\(p\)</span>) process, the autocorrelation function should decay exponentially, with possible oscillation patterns.</li>
<li>For an ARMA(<span class="math inline">\(p, q\)</span>) model, the pattern is irregular for lags <span class="math inline">\(k = 1, \ldots, p\)</span> and go to zero as <span class="math inline">\(k \to \infty\)</span>.</li>
</ul>
<ol start="3" style="list-style-type: decimal">
<li>Partial correlogram</li>
</ol>
<ul>
<li>Parameters should be zero at lags <span class="math inline">\(k&gt;p\)</span> for the AR(<span class="math inline">\(p\)</span>) model, and nonzero otherwise</li>
<li>The parameters decay exponentially in the MA(<span class="math inline">\(q\)</span>) model</li>
<li>The parameters decrease to zero as <span class="math inline">\(k \to \infty\)</span> for the ARMA(<span class="math inline">\(p, q\)</span>) model.</li>
</ul>
<p>The function to fit these models is <code>arima</code>, whose arguments are specified via <code>order = c(p, d, q)</code>. Ignore the <code>d</code> component for now in the triple <span class="math inline">\((p, d, q)\)</span> by setting it to zero. Other options are <code>sarima</code> from <code>astsa</code>, which is a wrapper around <code>arima</code>. <code>sarima</code> provides diagnostic plots alongside and includes a constant by default, but the syntax differs from <code>arima</code> and it takes directly components <span class="math inline">\(p\)</span>, <span class="math inline">\(d\)</span> and <span class="math inline">\(q\)</span>. The function <code>Arima</code> from Hyndman’s <code>forecast</code> package is yet another wrapper around <code>arima</code>. An explanation of the differences can be found in <a href="https://www.otexts.org/fpp/8/7">Forecasting: principles and practice</a>, at the bottom of the page.</p>
<blockquote>
<p>The <code>Arima()</code> command from the <code>forecast</code> package provides more flexibility on the inclusion of a constant</p>
</blockquote>
<p>It also correctly labels the latter. Depending on your model, it may be the level (mean), an intercept, the linear trend (slope, or drift in the time serie literature). If we take first difference, the constant is the drift, etc.</p>
<p><strong>Warning</strong>: You may stumble on the web on <code>auto.arima.</code> Beware of the naive and automated selection implemented by this function (which relies on what I would consider to be an <em>ad hoc</em> forward model selection). Use at your own risk.</p>
<p>ARMA models can be almost equivalent, as the following example from Shumway and Stoffer (example 3.28) illustrates. Note that as we use <code>sarima</code>, a constant is included by default. We can assess its significance by the usual <span class="math inline">\(t\)</span>-test, if the error structure is appropriate.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(astsa)
gnpgr =<span class="st"> </span><span class="kw">diff</span>(<span class="kw">log</span>(gnp))  <span class="co"># growth rate of GNP</span>
main &lt;-<span class="st"> &quot;Quarterly growth rate</span><span class="ch">\n</span><span class="st"> of U.S. GNP&quot;</span>
<span class="kw">plot</span>(gnpgr, <span class="dt">main =</span> main, <span class="dt">ylab =</span> <span class="st">&quot;Growth rate&quot;</span>)</code></pre></div>
<p><img src="timeseRies_files/figure-html/unnamed-chunk-12-1.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># There is a different mean in each quarter, but forego the seasonal effect</span>
<span class="co"># This is obvious in the following plot, which plots (in order), separating</span>
<span class="co"># by quarter monthplot(gnpgr, main = main, ylab = &#39;Growth rate&#39;, xlab =</span>
<span class="co"># &#39;Quarter&#39;)</span>
<span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))
TSA<span class="op">::</span><span class="kw">acf</span>(gnpgr, <span class="dv">24</span>, <span class="dt">main =</span> main)
<span class="kw">pacf</span>(gnpgr, <span class="dv">24</span>, <span class="dt">main =</span> main)</code></pre></div>
<p><img src="timeseRies_files/figure-html/unnamed-chunk-12-2.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># What does the period in the correlogram correspond to?</span></code></pre></div>
<p>The decrease in ACF/PACF suggests that either an AR(1) or an MA(2) might be appropriate here.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">mod1 &lt;-<span class="st"> </span><span class="kw">sarima</span>(gnpgr, <span class="dt">p =</span> <span class="dv">1</span>, <span class="dt">d =</span> <span class="dv">0</span>, <span class="dt">q =</span> <span class="dv">0</span>, <span class="dt">details =</span> <span class="ot">FALSE</span>)  <span class="co"># AR(1)</span>
<span class="kw">print</span>(mod1<span class="op">$</span>ttable)</code></pre></div>
<pre><code>      Estimate     SE t.value p.value
ar1     0.3467 0.0627  5.5255       0
xmean   0.0083 0.0010  8.5398       0</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">mod2 &lt;-<span class="st"> </span><span class="kw">sarima</span>(gnpgr, <span class="dt">p =</span> <span class="dv">0</span>, <span class="dt">d =</span> <span class="dv">0</span>, <span class="dt">q =</span> <span class="dv">2</span>, <span class="dt">details =</span> <span class="ot">FALSE</span>)  <span class="co"># MA(2)</span>
<span class="kw">print</span>(mod2<span class="op">$</span>ttable)</code></pre></div>
<pre><code>      Estimate     SE t.value p.value
ma1     0.3028 0.0654  4.6272  0.0000
ma2     0.2035 0.0644  3.1594  0.0018
xmean   0.0083 0.0010  8.7178  0.0000</code></pre>
<p>Having fitted these two models, we compare them using their linear proces (or MA(<span class="math inline">\(\infty\)</span>) representation) and the theoretical autocorrelation and partial autocorrelation coefficients.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Obtain the coefficients from the MA(Inf)</span>
<span class="kw">ARMAtoMA</span>(<span class="dt">ar =</span> mod1<span class="op">$</span>fit<span class="op">$</span>coef[<span class="dv">1</span>], <span class="dt">ma =</span> <span class="dv">0</span>, <span class="dv">4</span>)  <span class="co"># prints first 4 psi-weights</span></code></pre></div>
<pre><code>[1] 0.34665450 0.12016934 0.04165724 0.01444067</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Print sample ACF and superpose the theoretical coefficients implied by the</span>
<span class="co"># model</span>
<span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))
TSA<span class="op">::</span><span class="kw">acf</span>(gnpgr, <span class="dv">10</span>, <span class="dt">main =</span> main)
<span class="kw">points</span>(<span class="kw">seq</span>(<span class="dv">0</span>, <span class="dt">by =</span> <span class="fl">0.25</span>, <span class="dt">length =</span> <span class="dv">11</span>), <span class="dt">y =</span> <span class="kw">ARMAacf</span>(<span class="dt">ar =</span> mod1<span class="op">$</span>fit<span class="op">$</span>coef[<span class="dv">1</span>], <span class="dt">lag.max =</span> <span class="dv">10</span>), 
    <span class="dt">col =</span> <span class="st">&quot;blue&quot;</span>)
<span class="kw">points</span>(<span class="kw">seq</span>(<span class="dv">0</span>, <span class="dt">by =</span> <span class="fl">0.25</span>, <span class="dt">length =</span> <span class="dv">11</span>), <span class="dt">y =</span> <span class="kw">ARMAacf</span>(<span class="dt">ma =</span> mod2<span class="op">$</span>fit<span class="op">$</span>coef[<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>], 
    <span class="dt">lag.max =</span> <span class="dv">10</span>), <span class="dt">col =</span> <span class="st">&quot;red&quot;</span>)

<span class="kw">pacf</span>(gnpgr, <span class="dv">10</span>, <span class="dt">main =</span> main)
<span class="kw">points</span>(<span class="kw">seq</span>(<span class="fl">0.25</span>, <span class="dt">by =</span> <span class="fl">0.25</span>, <span class="dt">length =</span> <span class="dv">10</span>), <span class="dt">y =</span> <span class="kw">ARMAacf</span>(<span class="dt">ar =</span> mod1<span class="op">$</span>fit<span class="op">$</span>coef[<span class="dv">1</span>], 
    <span class="dt">lag.max =</span> <span class="dv">10</span>, <span class="dt">pacf =</span> <span class="ot">TRUE</span>), <span class="dt">col =</span> <span class="st">&quot;blue&quot;</span>)
<span class="kw">points</span>(<span class="kw">seq</span>(<span class="fl">0.25</span>, <span class="dt">by =</span> <span class="fl">0.25</span>, <span class="dt">length =</span> <span class="dv">10</span>), <span class="dt">y =</span> <span class="kw">ARMAacf</span>(<span class="dt">ma =</span> mod2<span class="op">$</span>fit<span class="op">$</span>coef[<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>], 
    <span class="dt">lag.max =</span> <span class="dv">10</span>, <span class="dt">pacf =</span> <span class="ot">TRUE</span>), <span class="dt">col =</span> <span class="st">&quot;red&quot;</span>)</code></pre></div>
<p><img src="timeseRies_files/figure-html/gnp_ar1orma2_comparison-1.png" width="672" /></p>
<p><strong>Warning</strong>: in the example above, it is necessary here to add a constant coefficient. Economic theory suggest exponential growth, hence a trend of <span class="math inline">\(\exp(t \beta)\)</span>. This becomes a linear trend <span class="math inline">\(t\beta\)</span> for log returns, and by differencing, we obtain the trend <span class="math inline">\(\beta\)</span>. The latter corresponds to the long term trend, or the quarterly growth rate, which is about 1%. The coefficient is significant even if it seems small and failing to include it leads to invalid inference about the state of the U.S. economy.</p>
<p>The last step is to check whether our process is causal and invertible. For the former, <code>arima</code> typically transforms to the stationary and invertible solution, so we should be good. We may end up having a root of <span class="math inline">\(\Phi(B)\)</span> or <span class="math inline">\(\Theta(B)\)</span> on the unit circle. In this case, the ARMA process is not stationary, while in the second, asymptotic normality of the estimator breaks down. We look at the roots of the polynomial <span class="math inline">\(\Phi(B)\)</span> and <span class="math inline">\(\Theta(B)\)</span> and check they indeed are outside the unit circle. It is easiest to check their norm or modulus.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Is the MA(2) process invertible?</span>
<span class="kw">abs</span>(<span class="kw">polyroot</span>(<span class="kw">c</span>(<span class="dv">1</span>, mod2<span class="op">$</span>fit<span class="op">$</span>coef[<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>])))  <span class="co">#MA roots</span></code></pre></div>
<pre><code>[1] 2.216653 2.216653</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Is the AR(1) process causal</span>
<span class="kw">Mod</span>(<span class="kw">polyroot</span>(<span class="kw">c</span>(<span class="dv">1</span>, <span class="op">-</span>mod1<span class="op">$</span>fit<span class="op">$</span>coef[<span class="dv">1</span>])))  <span class="co">#AR roots</span></code></pre></div>
<pre><code>[1] 2.884717</code></pre>
<p>Sometimes models give similar output. The model choice should then be made on the grounds of <strong>parsimony</strong>: a simpler model that explains the data should be prefered. If the models are nested, for example an AR(1) and an AR(2), then a likelihood ratio test can be performed (watch out to make sure the same number of observations appear in the models if using a conditional likelihood). A quick way to do this is by looking at the Akaike’s information criterion. There are other information criterion, notably the BIC and bias-corrected version of AIC termed <span class="math inline">\(\mathrm{AIC}_{\mathrm{c}}\)</span>. They are defined respectively as</p>
<p><span class="math display">\[
\begin{align*}
\mathrm{AIC}&amp; = -2\ell(\boldsymbol{\theta})+2k,\\
\mathrm{BIC}&amp; = -2\ell(\boldsymbol{\theta})+k\log(n),\\
\mathrm{AIC}_{\mathrm{c}}&amp; = -2\ell(\boldsymbol{\theta})+2 \frac{kn}{n-k-1}.
\end{align*}
\]</span></p>
<p>In the formulas above, <span class="math inline">\(n\)</span> is the sample size, <span class="math inline">\(k\)</span> is the number of parameters in the model and <span class="math inline">\(\ell\)</span> is log-likelihood. Since likelihood values increase with the number of parameters provided the models are nested (why?), the additional term penalizes complex models. The Schwartz’s information criterion (or Bayesian information criterion, BIC in short) includes the sample size in the penalty. The penalty could be viewed as a testing procedure similar to likelihood ratio test for nested models, where in place of the quantiles of the <span class="math inline">\(\chi^2\)</span> distribution, one uses e.g. for AIC a threshold of <span class="math inline">\(2(k_1-k_2)\)</span>.</p>
<p>The BIC is consistent, meaning that it chooses the correct model with probability 1 as <span class="math inline">\(n \to \infty\)</span>. AIC is <em>not</em> consistent for model selection and this results typically in overfitting. For ARMA models models with zero mean, Brockwell and Davis advocate the use of a small-sample correction of AIC, AIC<span class="math inline">\(_\mathrm{c}\)</span>, with <span class="math inline">\(k = p+q+1\)</span>. The latter is equivalent to AIC when <span class="math inline">\(n \to \infty\)</span>.</p>
<p><strong>Warning</strong>: The information criterion returned by <code>astsa::sarima</code> does not correspond to the definition above; the one implemented can be found in Shumway and Stoffer’s book. The principle remains the same: the lower, the better.</p>
<p>Here is an illustrative example on the dataset in the following exercise with a helper function to find the roots of the polynomials. I would like to bring your attention to the fact about the difficulties of optimizing some time series models. For example, one often finds that the ARMA(2,1) fits as well as the AR(1), even when the latter is the true underlying model. However, a quick look at the output below is illustrative of the trouble that lies ahead.</p>
<p>In the next exercise, you will be asked to practice your skills on simulated datasets. Before letting you proceed, I want to illustrate the different commands for fitting e.g. an ARMA(2, 1) model, and see what comes out.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(forecast)
<span class="kw">library</span>(astsa)
<span class="kw">load</span>(<span class="kw">url</span>(<span class="st">&quot;http://sma.epfl.ch/~lbelzile/math342/Simulated_ARMA.RData&quot;</span>))

<span class="co"># Wrapper around arima from forecast library</span>
mod_a &lt;-<span class="st"> </span><span class="kw">arima</span>(x3, <span class="dt">order =</span> <span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">0</span>, <span class="dv">1</span>), <span class="dt">transform.pars =</span> <span class="ot">TRUE</span>)
mod_b &lt;-<span class="st"> </span><span class="kw">Arima</span>(x3, <span class="dt">order =</span> <span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">0</span>, <span class="dv">1</span>), <span class="dt">transform.pars =</span> <span class="ot">TRUE</span>)
<span class="co"># Arima returns BIC, AIC and AICC</span>
mod_c &lt;-<span class="st"> </span><span class="kw">sarima</span>(x3, <span class="dt">p =</span> <span class="dv">2</span>, <span class="dt">d =</span> <span class="dv">0</span>, <span class="dt">q =</span> <span class="dv">1</span>, <span class="dt">details =</span> <span class="ot">FALSE</span>)</code></pre></div>
<p><img src="timeseRies_files/figure-html/unnamed-chunk-13-1.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># sarima provides diagnostic plots unless `details=FALSE` unfortunately also</span>
<span class="co"># returns all the optimization steps from `arima` in the new version</span>
mod_a</code></pre></div>
<pre><code>
Call:
arima(x = x3, order = c(2, 0, 1), transform.pars = TRUE)

Coefficients:
         ar1      ar2     ma1  intercept
      1.0872  -0.3739  0.9621    -0.6908
s.e.  0.1142   0.1182  0.1310     0.5769

sigma^2 estimated as 0.7271:  log likelihood = -128.77,  aic = 267.54</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">mod_b</code></pre></div>
<pre><code>Series: x3 
ARIMA(2,0,1) with non-zero mean 

Coefficients:
         ar1      ar2     ma1     mean
      1.0872  -0.3739  0.9621  -0.6908
s.e.  0.1142   0.1182  0.1310   0.5769

sigma^2 estimated as 0.7574:  log likelihood=-128.77
AIC=267.54   AICc=268.18   BIC=280.57</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">mod_c</code></pre></div>
<pre><code>$fit

Call:
stats::arima(x = xdata, order = c(p, d, q), seasonal = list(order = c(P, D, 
    Q), period = S), xreg = xmean, include.mean = FALSE, optim.control = list(trace = trc, 
    REPORT = 1, reltol = tol))

Coefficients:
         ar1      ar2     ma1    xmean
      1.0872  -0.3739  0.9621  -0.6908
s.e.  0.1142   0.1182  0.1310   0.5769

sigma^2 estimated as 0.7271:  log likelihood = -128.77,  aic = 267.54

$degrees_of_freedom
[1] 96

$ttable
      Estimate     SE t.value p.value
ar1     1.0872 0.1142  9.5220  0.0000
ar2    -0.3739 0.1182 -3.1627  0.0021
ma1     0.9621 0.1310  7.3417  0.0000
xmean  -0.6908 0.5769 -1.1973  0.2341

$AIC
[1] 0.7612783

$AICc
[1] 0.7876612

$BIC
[1] -0.1345149</code></pre>
<p>You can (and should) check the roots of the AR and MA polynomials to make sure this is not happening. The argument <code>transform.pars</code> transforms the AR polynomial to the causal representation if it does not have a root on the unit circle. If the process is not invertible, the parameter lies on the boundary of the space and the usual standard errors obtained from the observed information matrix are not reliable. It is possible to use these models for forecasting, but their interpretation is awkward.</p>
<div id="exercise-2-simulated-series" class="section level3">
<h3><span class="header-section-number">2.2.1</span> Exercise 2: Simulated series</h3>
<ol style="list-style-type: decimal">
<li>The <code>Simulated_ARMA</code> dataset contains 8 time series (these examples are from Charlotte Wickham’s website). Fit ARMA models to those and select a model, justifying your choice. Be skeptical of the optimization routine and analyze the models carefully.</li>
</ol>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="manual-maximum-likelihood-estimation.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="information-criterion-model-selection-and-profile-likelihood.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"download": ["timeseRies.pdf", "timeseRies.epub"],
"toc": {
"collapse": "none"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "";
    if (src === "" || src === "true") src = "https://cdn.bootcss.com/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(src))
      src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
